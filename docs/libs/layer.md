# layer_lib - ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œãƒ©ã‚¤ãƒ–ãƒ©ãƒª

ç”»åƒãƒãƒƒãƒ•ã‚¡ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰ã‚’æ“ä½œã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚`HLayer` ãƒãƒ³ãƒ‰ãƒ«å‹ã¨ `Point`/`Size` ãƒ™ã‚¯ãƒˆãƒ«æ§‹é€ ä½“ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

## ãƒ˜ãƒƒãƒ€ãƒ•ã‚¡ã‚¤ãƒ«

ğŸ“„ [`libs/layer/include/layer/layer.h`](../../libs/layer/include/layer/layer.h)

---

## å‹å®šç¾©

```c
typedef struct { int x, y; } Point;       // 2Dåº§æ¨™
typedef struct { size_t w, h; } Size;     // ã‚µã‚¤ã‚º
typedef Layer* HLayer;                     // ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒ³ãƒ‰ãƒ«
typedef RGBA (*BlendFunc)(RGBA dst, RGBA src);  // åˆæˆé–¢æ•°
```

### ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒã‚¯ãƒ­

```c
POINT(x, y)  // Point ã‚’ç”Ÿæˆ
SIZE(w, h)   // Size ã‚’ç”Ÿæˆ
```

---

## è¨­è¨ˆæ¦‚è¦

### ãƒãƒ³ãƒ‰ãƒ«å‹ãƒ‘ã‚¿ãƒ¼ãƒ³

`HLayer` ã¯ `Layer*` ã® typedef ã§ã™ã€‚æ§‹é€ ä½“ã®å†…éƒ¨ã‚’éš è”½ã—ã€é–¢æ•°ã‚’é€šã˜ã¦ã®ã¿æ“ä½œã—ã¾ã™ã€‚

### åº§æ¨™ç³»

- åŸç‚¹ã¯ **å·¦ä¸Š**
- Xè»¸ã¯å³æ–¹å‘ã€Yè»¸ã¯ä¸‹æ–¹å‘
- ãƒ”ã‚¯ã‚»ãƒ«åº§æ¨™ã¯ **0-indexed**

### ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚¹

- åŸºæœ¬æç”»é–¢æ•°ï¼ˆ`layer_draw_*`ï¼‰ã¯ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚¹ãªã—
- AAç‰ˆï¼ˆ`layer_draw_*_aa`ï¼‰ã¯ Xiaolin Wu ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ç­‰ã‚’ä½¿ç”¨
- ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ç”¨ã« `layer_downsample_2x` ã‚‚æä¾›

### å¤‰å½¢é–¢æ•°ã®å‘½åè¦å‰‡

| é–¢æ•°å | å‹•ä½œ |
|--------|------|
| `layer_clip` | ç ´å£Šçš„ï¼ˆå…ƒãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å¤‰æ›´ï¼‰ |
| `layer_clip_to` | æ–°ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œæˆï¼ˆå…ƒã¯å¤‰æ›´ã—ãªã„ï¼‰ |

---

## ä½¿ç”¨ä¾‹

```c
#include "layer/layer.h"

// 640x480 ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œæˆ
HLayer layer = layer_create(SIZE(640, 480));

// ç™½ã§å¡—ã‚Šã¤ã¶ã™
layer_fill(layer, rgba_new(1.0, 1.0, 1.0, 1.0));

// èµ¤ã„çŸ©å½¢ã‚’æç”»
layer_draw_rect(layer, POINT(50, 50), SIZE(100, 80),
                rgba_new(1.0, 0.0, 0.0, 1.0));

// AAå††ã‚’æç”»
layer_draw_circle_aa(layer, POINT(200, 200), 60,
                     rgba_new(0.0, 0.8, 0.0, 1.0));

// PPM ã§ä¿å­˜
layer_save_p6(layer, "output.ppm");

// ä½¿ç”¨å¾Œã¯å¿…ãšç ´æ£„
layer_destroy(layer);
```

---

## é–¢é€£

- [rgba_lib](rgba.md) - è‰²æ“ä½œï¼ˆlayer_lib ãŒä¾å­˜ï¼‰
- [layer.h](../../libs/layer/include/layer/layer.h) - å®Œå…¨ãªAPIå®£è¨€
